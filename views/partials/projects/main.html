<aside class="right" style="width: 22%">

	<input type="text" class="search" ng-model="projectSearch" placeholder="Search projects">
	<a href="" class="clear" ng-show="projectSearch" ng-click="clearProjectSearch()">Clear</a>

	<ul class="checkboxes" style="margin-top: 1em; padding-bottom: 0;">
		<li>
			<label for="open">
				<input type="checkbox" id="open" ng-click="setStatusProjects('open')" ng-checked="statusProjects == 'open'"> Open projects
			</label>
		</li>
		<li>
			<label for="closed">
				<input type="checkbox" id="closed" ng-click="setStatusProjects('closed')" ng-checked="statusProjects == 'closed'"> Completed projects
			</label>
		</li>
	</ul>

	<ul class="checkboxes">
		<li ng-repeat="category in categoryList">
			<label for="{{category.slug}}">
				<input type="checkbox" id="{{category.slug}}" value="{{category._id}}" ng-checked="categoriesProjects.indexOf(category._id) > -1" ng-click="categoryToggle(category._id)"> 
				<span class="color-block" style="background-color: {{category.color }};"></span>
				{{category.name}}
			</label>
		</li>
	</ul>

	<ul class="select">
		<li>
			<label for="projects-sort">Sort by</label>
			<select ng-model="sortProjects" id="projects-sort" ng-change="setSortProjects()">
				<option value="-postDate">Post date</option>
				<option value="title">Title</option>
				<option value="start">Start date</option>
				<option value="end">End date</option>
			</select>
		</li>	
	</ul>

	<ul class="links">
		<li><a href="/#/projects/create">Create project</a></li>
	</ul>	
</aside>

<ul class="project-list content left" style="width: 78%">
	<li class="no-projects" ng-show="projectList.length == 0">No results <span ng-show="projectSearch">for <em>{{projectSearch}}</em></span></li>
	<li ng-repeat="project in projectList">
		<div class="project-left">
			
			<h2>
				<a href="/#/projects/{{project.slug}}" ng-class="{completed: project.completed == true}" ng-bind-html="project.title | highlight: projectSearch">Project title</a> 
				<small ng-show="project.completed == true">Completed</small>
			</h2>

			<small class="project-period">
				<span ng-show="project.start">{{displayDate(project.start)}}</span>
				<span ng-show="project.start && project.end"> &mdash; </span> 
				<span ng-show="project.end">{{displayDate(project.end)}}</span> 
				(<em>{{project.time}}</em>) 
			</small>

			<div ng-show="project.description" class="project-description">{{project.description}}</div>
		</div>

		<div class="project-right">
			<ul class="project-participants">
				<small class="project-participants-count" ng-show="project.participants.length == 0">No participants</small>
				<small class="project-participants-count" ng-show="project.participants.length == 1">1 participant:</small>
				<small class="project-participants-count" ng-show="project.participants.length > 1">{{project.participants.length}} participants:</small>
				
				<li ng-repeat="participant in project.participants"  ng-class="{owner: project.owner == participant._id}">
					<img src="/avatar.gif" title="{{participant.name.first}} {{participant.name.last}}">
				</li>
			</ul>

			<ul class="project-tasks">
				<small class="project-tasks-count" ng-show="project.tasks.length == 0">No tasks</small>
				<small class="project-tasks-count" ng-show="project.tasks.length == 1">1 task / {{project.completedTasks}} completed:</small>
				<small class="project-tasks-count" ng-show="project.tasks.length > 1">{{project.tasks.length}} tasks / {{project.completedTasks}} completed:</small>
				
				<li ng-repeat="task in project.tasks | limitTo: 3">
					{{task.title}}
				</li>
				<li ng-show="project.tasks.length > 3"><a href="/#/projects/{{project.slug}}">More...</a></li>
			</ul>			
		</div>

		<div class="project-meta">
			<dl>
				<dt>Author:</dt>
				<dd>
					<strong>{{project.author.name.first}} {{project.author.name.last}}</strong> 
					<small><time datetime="{{project.postDate}}">{{fromNow(project.postDate)}}</time></small>
				</dd>
				<dt ng-if="project.editor">Editor:</dt>
				<dd ng-if="project.editor">
					<strong>{{project.editor.name.first}} {{project.editor.name.last}}</strong>
					<small><time datetime="{{project.editDate}}">{{fromNow(project.editDate)}}</time></small>
				</dd>
			</dl>
			
			<ul class="badges" ng-if="project.categories">
				<li ng-repeat="category in project.categories" style="background-color: {{category.color}}" title="{{category.name}}">
					{{category.name}}
				</li>
			</ul>
		</div>
	</li>
</ul>

<div class="project-nav content left" ng-hide="projectSearch || projectsPages < 2" style="width: 78%">
	<a href="" class="project-prev" ng-show="projectsPage > 0" ng-click="navProjects('prev')">&laquo; Previous</a>
	{{(projectsPage + 1)}} of {{projectsPages}} 
	<a href="" class="project-next" ng-show="projectsPage + 1 < projectsPages" ng-click="navProjects('next')">Next &raquo;</a>
</div>